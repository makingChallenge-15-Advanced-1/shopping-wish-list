<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

    <title>í†µí•© ì‡¼í•‘ ì°œë°”êµ¬ë‹ˆ</title>
    <link href="https://fonts.googleapis.com/css2?family=Gamja+Flower&family=Noto+Sans+KR&family=Single+Day&display=swap" rel="stylesheet">

    <style>
        * {
            font-family: 'Single Day', cursive;
        }

        .mytitle {
            width: 100%;
            height: 250px;

            background-image: linear-gradient(0deg, rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://www.incimages.com/uploaded_files/image/1920x1080/getty_522735456_249841.jpg');
            background-position: center;
            background-size: cover;

            color: white;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .mytitle > button {
            width: 200px;
            height: 50px;

            background-color: transparent;
            color: white;

            border-radius: 50px;
            border: 1px solid white;

            padding-top: 10px;
            margin: 10px 0px 20px 0px;
        }
        .mytitle > button:hover {
            border: 2px solid white;
        }

        .mycards {
            margin: 20px auto 0px auto;
            width: 95%;
            max-width: 1300px;
        }

        .mypost {
            width: 95%;
            max-width: 500px;
            margin: 20px auto 0px auto;
            padding: 20px;
            box-shadow: 0px 0px 3px 0px gray;

            display: none;
        }

        .no_item_list {
            width: 90%;
            height: 300px;
            margin: 20px auto 0px auto;
            padding: 20px;
            box-shadow: 0px 0px 3px 0px gray;

            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
        }

        .mymodifier {
            width: 95%;
            max-width: 500px;
            margin: 20px auto 0px auto;
            padding: 20px;
            box-shadow: 0px 0px 3px 0px gray;

            display: none;
        }

        .form-floating{
            margin: 10px auto 15px auto;
        }

        .mybtns {
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;

            margin-top: 20px;
        }
        .mybtns > button {
            margin-right: 10px;
        }

        .card-body > input {
            color: lightgrey;
        }
        .card-body > input:hover {
            color: grey;
        }
    </style>
    <script>
        var url_verifier = 'false';

        $(document).ready(function(){       //í˜ì´ì§€ ë¡œë”© ì‹œ listing_all() í•¨ìˆ˜ í˜¸ì¶œ
            url_verifier = 'false';
            listing_all();
        });
    
        // DB ì •ë³´ë¥¼ í‘œì‹œí•´ ì£¼ëŠ” í•¨ìˆ˜ë“¤
        function list_to_card(wishlist){        //ë°›ì€ listë¥¼ ì¹´ë“œë¡œ ë§Œë“¤ì–´ í™”ë©´ì— ì¶”ê°€í•´ ì£¼ëŠ” í•¨ìˆ˜
            for(let i = 0; i < wishlist.length; i++){
                let image = wishlist[i]['image']
                let url = wishlist[i]['url']
                let name = wishlist[i]['name']
                let memo = wishlist[i]['memo']
                let price = wishlist[i]['price']
                let status = wishlist[i]['status']
                console.log(url, name, price, status)
                temp_html = `
                    <div class="col">
                        <div class="card">
                        <img src="${image}" class="card-img-top" alt="...">
                        <div class="card-body">
                            <h5 class="card-title">"ìƒí’ˆëª… : ${name}"</h5>
                            <p class="card-text">"ë©”ëª¨ : ${memo}"</p>
                            <p class="card-text">"ê°€ê²© : ${price}"</p>
                            <p class="card-text">"ìƒíƒœ : ${status}"</p>
                        </div>
                        </div>
                    </div>
                `
                $('#cards-box').append(temp_html)
            }
            return
        }

        function listing_all() {                //ëª¨ë“  ì •ë³´ë¥¼ ë³´ì—¬ì¤Œ
            $('#cards-box').empty()
            $.ajax({                        //ajax GETìœ¼ë¡œ listë¥¼ ì½ì–´ì™€ì„œ ì¹´ë“œ ìƒì„±
                type: 'GET',                //ë°›ëŠ” ë³€ìˆ˜ : image, url, name, price, memo, status, listId
                url: '/wishlist/all',
                data: {},
                success: function (response) {
                    all_wishlist = response['all_wishlist']
                    list_to_card(all_wishlist)
                }
            })
        }
        function listing_ready() {          //ë‹¹ì¥êµ¬ë§¤ ì•„ì´í…œë§Œ ë³´ì—¬ì¤Œ
            $('#cards-box').empty()
            $.ajax({                        //ajax GETìœ¼ë¡œ listë¥¼ ì½ì–´ì™€ì„œ ì¹´ë“œ ìƒì„±
                type: 'GET',                //ë°›ëŠ” ë³€ìˆ˜ : image, url, name, price, memo, status, listId
                url: '/wishlist/ready',
                data: {},
                success: function (response) {
                    ready_wishlist = response['ready_wishlist']
                    list_to_card(ready_wishlist)
                }
            })
        }
        function listing_refer() {          //ë³´ë¥˜ ì•„ì´í…œë§Œ ë³´ì—¬ì¤Œ
            $('#cards-box').empty()
            $.ajax({                        //ajax GETìœ¼ë¡œ listë¥¼ ì½ì–´ì™€ì„œ ì¹´ë“œ ìƒì„±
                type: 'GET',                //ë°›ëŠ” ë³€ìˆ˜ : image, url, name, price, memo, status, listId
                url: '/wishlist/refer',
                data: {},
                success: function (response) {
                    refer_wishlist = response['refer_wishlist']
                    list_to_card(refer_wishlist)
                }
            })
        }
        function listing_done() {          //êµ¬ë§¤ì™„ë£Œ ì•„ì´í…œë§Œ ë³´ì—¬ì¤Œ
            $('#cards-box').empty()
            $.ajax({                        //ajax GETìœ¼ë¡œ listë¥¼ ì½ì–´ì™€ì„œ ì¹´ë“œ ìƒì„±
                type: 'GET',                //ë°›ëŠ” ë³€ìˆ˜ : image, url, name, price, memo, status, listId
                url: '/wishlist/done',
                data: {},
                success: function (response) {
                    done_wishlist = response['done_wishlist']
                    list_to_card(done_wishlist)
                }
            })
        }


        //DBì— ìƒˆë¡œìš´ ì •ë³´ë¥¼ ì¶”ê°€í•˜ëŠ” í•¨ìˆ˜
        function posting() {
            if (url_verifier == 'false'){
                alert('urlì´ ë§ëŠ”ì§€ ê²€ì‚¬í•´ ì£¼ì„¸ìš”!!');
                return
            }
            let url = $('#url_input').val()    //ë³€ìˆ˜ : url, name, price, memo, status
            let name = $('#name_input').val()
            let price = $('#price_input').val()
            let memo = $('#memo_input').val()
            let status = $('#status_input').val()
            $.ajax({
                type: 'POST',
                url: '/wishlist',
                data: {url_give: url, name_give: name, price_give: price, memo_give: memo, status_give: status},
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()
                }
            });
        }


        //íŠ¹ì • listIdë¥¼ ê°€ì§„ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ìˆ˜ì •
        function modifying(listId) {          
            let url = $('#url_modify').val()    
            let name = $('#name_modify').val()
            let price = $('#price_modify').val()
            let memo = $('#memo_modify').val()
            let status = $('#status_modify').val()   //status ë¶€ë¶„ ìˆ˜ì •í•˜ê¸°
            $.ajax({                                 //ë³€ìˆ˜: url, name, price, memo, status, listId
                type: 'PUT',
                url: '/wishlist/listId',
                data: {url_give: url, name_give: name, price_give: price, memo_give: memo, status_give: status, listId_give: listId},
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()
                }
            });
        }
        //ìƒíƒœë§Œ ìˆ˜ì •í•˜ëŠ” í•¨ìˆ˜
        function modifying_status(listId){
            let status = $('#status_modify').val()        //status ë¶€ë¶„ ìˆ˜ì •í•˜ê¸°
            $.ajax({                                      //ë³€ìˆ˜: status, listId
                type: 'PUT',
                url: '/wishlist/listId/status',
                data: {status_give: status, listId_give: listId},
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()
                }
            });
        }

        //íŠ¹ì • listIdë¥¼ ê°€ì§„ ì •ë³´ë¥¼ ì‚­ì œ
        function deleting(listId){            
            $.ajax({
                type: 'DELETE',
                url: '/wishlist/listId',
                data: {listId_give: listId},
                success: function (response) {
                    alert(response['msg'])
                    window.location.reload()
                }
            });
        }

        //url í˜•ì‹ì´ ë§ëŠ”ì§€ ê²€ì¦í•˜ëŠ” í•¨ìˆ˜. url ê²€ì¦ ë²„íŠ¼ì—ì„œ call
        function url_certifi(){
            let url = $('#url_input').val()

            if(url == ""){
                alert("URLì„ ì…ë ¥í•´ ì£¼ì„¸ìš”!!")
                return
            }
            //url í˜•ì‹ ê²€ì¦
            let regex =  /^(((http(s?))\:\/\/)?)([0-9a-zA-Z\-]+\.)+[a-zA-Z]{2,6}(\:[0-9]+)?(\/\S*)?/;

            if (regex.test(url)) {
                // location.href = url;     í•´ë‹¹ urlë¡œ ì´ë™í•˜ëŠ” ì‹
                alert(url)
                url_verifier = 'true'
                return
            }else {
                alert("ìœ íš¨í•˜ì§€ ì•Šì€ urlì…ë‹ˆë‹¤")
                return
            }
        }

        //box open&close í•¨ìˆ˜ë“¤
        function open_posting_box(){            //ìƒí’ˆ ë“±ë¡ ë°•ìŠ¤ë¥¼ open
            $('#posting-box').show()
        }
        function close_posting_box(){           //ìƒí’ˆ ë“±ë¡ ë°•ìŠ¤ë¥¼ close
            $('#posting-box').hide()
        }

        function open_modify_box(listId) {         //ìƒí’ˆ ìˆ˜ì • ë°•ìŠ¤ë¥¼ open
            $('#modify-box').empty()
            $.ajax({                            //ê¸°ì¡´ ì •ë³´ë¥¼ ë¡œë”©í•´ì„œ ë°•ìŠ¤ì— ë¿Œë ¤ì¤Œ
                type: 'GET',                    //ë°›ëŠ” ë³€ìˆ˜ : image, url, name, price, memo, status
                url: '/wishlist/listId?listId_give='+listId,
                data: {},
                success: function (response) { 
                    alert(response['msg'])
                }
            })
        }
        function close_modify_box() {           //ìƒí’ˆ ìˆ˜ì • ë°•ìŠ¤ë¥¼ close
            $('#modify-box').hide()
        }

        function open_delete_box(){            //ìƒí’ˆ ì‚­ì œ ë°•ìŠ¤ë¥¼ open
            $('#delete-box').show()
        }
        function close_delete_box(){           //ìƒí’ˆ ì‚­ì œ ë°•ìŠ¤ë¥¼ close
            $('#delete-box').hide()
        }
    </script>
</head>

<body>
<div class="mytitle">
    <h1><b>ë‚˜ë§Œì˜ ì°œ ì¥ë°”êµ¬ë‹ˆ</b></h1>
    <button onclick="open_posting_box()"><h4><b>ìƒí’ˆ ì¶”ê°€</b></h4></button>
    <div class="btn-group" role="group" aria-label="Basic outlined example">
        <button onclick="listing_all()" type="button" class="btn btn-outline-light">ì „ì²´ë³´ê¸°</button>
        <button onclick="listing_ready()" type="button" class="btn btn-outline-light">êµ¬ë§¤ì˜ˆì •ğŸ“Œ</button>
        <button onclick="listing_refer()" type="button" class="btn btn-outline-light">ë³´ë¥˜â™»</button>
        <button onclick="listing_done()" type="button" class="btn btn-outline-light">êµ¬ë§¤ì™„ë£Œâœ…</button>
    </div>
</div>
<div class="mypost" id="posting-box">
    <div class="form-floating" id="url-box">
        <input type="text" class="form-control" id="url_input" placeholder="url">
        <button onclick="url_certifi()">url ê²€ì¦</button>
        <label for="url_input">URL</label>
    </div>
    <div class="form-floating">
        <input type="title" class="form-control" id="floatingtitle" placeholder="title">
        <label for="floatingtitle">ìƒí’ˆì´ë¦„</label>
    </div>
    <div class="form-floating">
        <input type="title" class="form-control" id="floatingmodel" placeholder="title">
        <label for="floatingtitle">ê°€ê²©</label>
    </div>
    <div class="form-floating">
        <input type="text" class="form-control" id="memo_input" placeholder="memo">
        <label for="memo_input">ë©”ëª¨</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_done" value="êµ¬ë§¤ì™„ë£Œ">
        <label class="form-check-label" for="check_done">êµ¬ë§¤ì˜ˆì •</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_defer" value="ë³´ë¥˜í•˜ê¸°">
        <label class="form-check-label" for="check_defer">ë³´ë¥˜</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_done" value="êµ¬ë§¤ì™„ë£Œ">
        <label class="form-check-label" for="check_done">êµ¬ë§¤ì™„ë£Œ</label>
    </div>
    <div class="mybtns">
        <button onclick="posting()" type="button" class="btn btn-dark">ë“±ë¡</button>
        <button onclick="close_box()" type="button" class="btn btn-outline-dark">ì·¨ì†Œ</button>
    </div>
</div>

<div class="mymodifier" id="modify-box">
    <div class="form-floating" id="url-box">
        <input type="text" class="form-control" id="url_input" placeholder="url">
        <button onclick="url_certifi()">url ê²€ì¦</button>
        <label for="url_input">URL</label>
    </div>
    <div class="form-floating">
        <input type="title" class="form-control" id="floatingtitle" placeholder="title">
        <label for="floatingtitle">ìƒí’ˆì´ë¦„</label>
    </div>
    <div class="form-floating">
        <input type="title" class="form-control" id="floatingmodel" placeholder="title">
        <label for="floatingtitle">ê°€ê²©</label>
    </div>
    <div class="form-floating">
        <input type="title" class="form-control" id="floatingmemo" placeholder="title" >
        <label for="floatingtitle">ë©”ëª¨</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_done" value="êµ¬ë§¤ì™„ë£Œ">
        <label class="form-check-label" for="check_done">êµ¬ë§¤ì˜ˆì •</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_defer" value="ë³´ë¥˜í•˜ê¸°">
        <label class="form-check-label" for="check_defer">ë³´ë¥˜</label>
    </div>
    <div class="form-check form-check-inline">
        <input class="form-check-input" type="radio" id="check_done" value="êµ¬ë§¤ì™„ë£Œ">
        <label class="form-check-label" for="check_done">êµ¬ë§¤ì™„ë£Œ</label>
    </div>
    <div class="mybtns">
        <button onclick="modifying()" type="button" class="btn btn-dark">ìˆ˜ì •</button>
        <button onclick="close_modify_box()" type="button" class="btn btn-outline-dark">ì·¨ì†Œ</button>
    </div>
</div>

<div class="mycards">
    <div class="row row-cols-1 row-cols-md-3 g-3" id="cards-box">
        <div class="col">
            <div class="card h-100">
                <h5 class="card-header"><b>í’ˆëª…</b></h5>
                <div class="card-body">
                    <h5 class="card-title">ëª¨ë¸ëª…</h5>
                    <h6 class="card-subtitle mb-2 text-muted">êµ¬ì…ì™„ë£Œ / ë³´ìœ ìˆ˜ëŸ‰ 3ê°œ</h6>
                    <p class="card-text">ë©”ëª¨ëŠ” ì—¬ê¸°ì— ì ê¸°</p>
                    <input onclick="open_modifier()" type='button' class='btn' name='btn' value='ìˆ˜ì •í•˜ê¸°' style="float: right;">
                </div>
                <button type="button" class="btn btn-outline-secondary">êµ¬ë§¤ì˜ˆì •ìœ¼ë¡œ ë³€ê²½</button>
            </div>
        </div>
        <div class="col">
            <div class="card h-100">
                <h5 class="card-header"><b>í’ˆëª…</b></h5>
                <div class="card-body">
                    <h5 class="card-title">ëª¨ë¸ëª…</h5>
                    <h6 class="card-subtitle mb-2 text-muted">êµ¬ë§¤ë³´ë¥˜ / ë³´ìœ ìˆ˜ëŸ‰ 0ê°œ</h6>
                    <p class="card-text">ë©”ëª¨ëŠ” ì—¬ê¸°ì— ì ê¸°</p>
                    <input onclick="open_modifier()" type='button' class='btn' name='btn' value='ìˆ˜ì •í•˜ê¸°' style="float: right;">
                </div>
                <button type="button" class="btn btn-outline-secondary">ë³´ë¥˜ í•´ì œí•˜ê¸°</button>
            </div>
        </div>
        <div class="col">
            <div class="card h-100">
                <h5 class="card-header"><b>í’ˆëª…</b></h5>
                <div class="card-body">
                    <h5 class="card-title">ëª¨ë¸ëª…</h5>
                    <h6 class="card-subtitle mb-2 text-muted">êµ¬ë§¤ì˜ˆì • / ë³´ìœ ìˆ˜ëŸ‰ 0ê°œ</h6>
                    <p class="card-text">ë©”ëª¨ëŠ” ì—¬ê¸°ì— ì ê¸°</p>
                    <input onclick="open_modifier()" type='button' class='btn' name='btn' value='ìˆ˜ì •í•˜ê¸°' style="float: right;">
                    </p>
                </div>
                <div class="btn-group" role="group" aria-label="Basic outlined example">
                    <button type="button" class="btn btn-outline-secondary">ë³´ë¥˜í•˜ê¸°</button>
                    <button type="button" class="btn btn-outline-secondary">êµ¬ì…ì™„ë£Œ</button>
                </div>
            </div>
        </div>
    </div>
</div>
</body>

</html>